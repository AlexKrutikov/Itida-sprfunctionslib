	ДобавитьКонтекст("SELECT ISNULL( v.КодВидаПродукции, m.КодВидаПродукции) AS КодВидаПродукции, ISNULL( v.ИДПроизвИмп, m.ИДПроизвИмп ) AS ИДПроизвИмп, v.ИдПостав, 							 ISNULL( v.ВидПродукции, m.ВидПродукции ) AS ВидПродукции, ISNULL( v.НаименованиеПроизводителя, m.НаименованиеПроизводителя ) AS НаименованиеПроизводителя,							 ISNULL( v.ИННПроизводителя, m.ИННПроизводителя ) AS ИннПроизводителя, ISNULL( v.КПППроизводителя, m.КПППроизводителя ) AS КПППроизводителя, 							 v.НаименованиеПоставщика, v.ИННПоставщика, v.КПППоставщика, v.ЛицензияНомер, v.ЛицензияДатаВыдачи, v.ЛицензияДатаОкончания,							 v.ЛицензияКемВыдана, v.ДатаПоставки, v.НомерНакладной, v.НомерГТД, v.ОбъемПоставки, v.ОбъемВозвратов,  							 m.ОстатокНаНачало, m.ПоступлениеОтПроизводителей, m.ПоступлениеОтОптовиков, m.ПоступлениеПоИмпорту, m.ВозвратОтПокупателей, m.ПрочееПоступление, 							 ISNULL( m.ПоступлениеОтПроизводителей, 0 ) + ISNULL( m.ПоступлениеОтОптовиков, 0 ) + ISNULL( m.ПоступлениеПоИмпорту, 0 ) AS ИтогоПоступлений,							 ISNULL( m.ПоступлениеОтПроизводителей, 0 ) + ISNULL( m.ПоступлениеОтОптовиков, 0 ) + ISNULL( m.ПоступлениеПоИмпорту, 0 )+							 ISNULL( m.ВозвратОтПокупателей, 0 ) + ISNULL( m.ПрочееПоступление, 0 ) + ISNULL( m.ПоступлениеПоПеремещению, 0 ) AS ВсегоПоступлений,							 ISNULL( m.РасходРозница, 0 ) + ISNULL( m.РасходПрочий, 0 ) + ISNULL( m.РасходВозвратПоставщику, 0 ) + ISNULL( m.РасходПеремещение, 0 ) AS ВсегоРасход,							 m.ПоступлениеПоПеремещению, m.РасходРозница, m.РасходПрочий, m.РасходВозвратПоставщику, m.РасходПеремещение, m.ОстатокНаКонец, m.ОстатокНаКонецСтарыеМарки					 FROM " + ТаблицаОбъемов + " v					 FULL JOIN " + ТаблицаДвижений + " m ON v.КодВидаПродукции = m.КодВидаПродукции AND v.ИДПроизвИмп = m.ИДПроизвИмп AND v.Подразделение = m.Подразделение					 WHERE " + ЕСЛИ( ПУСТО( ПОДРАЗДЕЛЕНИЕ ), "", "ISNULL( m.Подразделение, v.Подразделение ) = '" + ПОДРАЗДЕЛЕНИЕ + "' AND " ) + "							( ROUND( m.ОстатокНаНачало, 5 ) <> 0 OR ROUND( m.ПоступлениеОтПроизводителей, 5 ) <> 0 OR ROUND( m.ПоступлениеОтОптовиков, 5 ) <> 0 OR							  ROUND( m.ПоступлениеПоИмпорту, 5 ) <> 0 OR ROUND( m.ВозвратОтПокупателей, 5 ) <> 0 OR ROUND( m.ПрочееПоступление, 5 ) <> 0 OR 							  ROUND( ISNULL( m.ПоступлениеОтПроизводителей, 0 ) + ISNULL( m.ПоступлениеОтОптовиков, 0 ) + ISNULL( m.ПоступлениеПоИмпорту, 0 ), 5 ) <> 0 OR 							  ROUND( ISNULL( m.ПоступлениеОтПроизводителей, 0 ) + ISNULL( m.ПоступлениеОтОптовиков, 0 ) + ISNULL( m.ПоступлениеПоИмпорту, 0 ) +									 ISNULL( m.ВозвратОтПокупателей, 0 ) + ISNULL( m.ПрочееПоступление, 0 ) + ISNULL( m.ПоступлениеПоПеремещению, 0 ), 5 ) <> 0 OR 							  ROUND( ISNULL( m.РасходРозница, 0 ) + ISNULL( m.РасходПрочий, 0 ) + ISNULL( m.РасходВозвратПоставщику, 0 ) + ISNULL( m.РасходПеремещение, 0 ), 5 ) <> 0 OR							  ROUND( m.ПоступлениеПоПеремещению, 5 ) <> 0 OR ROUND( m.РасходРозница, 5 ) <> 0 OR ROUND( m.РасходПрочий, 5 ) <> 0 OR 							  ROUND( m.РасходВозвратПоставщику, 5 ) <> 0 OR ROUND( m.РасходПеремещение, 5 ) <> 0 OR ROUND( m.ОстатокНаКонец, 5 ) <> 0 ) " +					 ЕСЛИ( !Поставки || !Возвраты, ЕСЛИ( Поставки, "AND ROUND( v.ОбъемПоставки, 5 ) <> 0", "AND ROUND( v.ОбъемВозвратов, 5 ) <> 0" ), "" ) + "												 ORDER BY 1, 2, 3", "СписокСведений"  );
