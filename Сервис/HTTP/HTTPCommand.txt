ОтветСервера		= "";IF ( ПУСТО( АДРЕССЕРВЕРА ) ) АДРЕССЕРВЕРА = ЕСЛИ( ПУСТО( ПОРТСЕРВЕРА ), HTTPHost, HTTPHostIP );IF ( !Сервис.HTTPConnect( АДРЕССЕРВЕРА, ПОРТСЕРВЕРА, true ) ) {	СООБЩЕНИЕ( "Не удалось подключиться к серверу. Проверьте параметры соединения (" + ALLTRIM( АДРЕССЕРВЕРА ) + ":" + ALLTRIM( ПОРТСЕРВЕРА ) + ")." );	RETURN false;}СообщениеОбОшибке	= "";IF ( ALLTRIM( UPPER( Команда ) ) == "GET" )	ОтветСервера		= Сервис.HTTPGet( mURL, @СообщениеОбОшибке );ELSE IF ( ALLTRIM( UPPER( Команда ) ) == "POST" )	ОтветСервера		= Сервис.HTTPPost( mURL, СтрокаДляОтправки, @СообщениеОбОшибке, ИмяФайла );ELSE IF ( ALLTRIM( UPPER( Команда ) ) == "DELETE" )	ОтветСервера		= Сервис.HTTPDelete( mURL, @СообщениеОбОшибке );ELSE	СообщениеОбОшибке	= "Неизвестная команда " + Команда;	Сервис.HTTPDisconnect( );// Если вернулся пустой ответ, то это означает ошибкуIF ( ПУСТО( ОтветСервера ) ){	IF ( !ПУСТО( СообщениеОбОшибке ) )	{		ИмяОперации		= "загрузке";		IF ( ALLTRIM( UPPER( Команда ) ) == "POST" )		{			ИмяОперации	= "отправке";						// Записываем отправляемый текст в журнал ошибок отправки			ФайлОшибки	= ФАЙЛОТКРЫТЬ( "httpposterror.log", 1, 1 );			ФАЙЛУСТАНОВИТЬУКАЗАТЕЛЬ( ФайлОшибки, 0, 0, 2 );			ФАЙЛЗАПИСАТЬСТРОКУ( ФайлОшибки, REPLICATE( "*", "80" ) );			ФАЙЛЗАПИСАТЬСТРОКУ( ФайлОшибки, TTOC( ДАТАВРЕМЯ( ) ) + ": " + ALLTRIM( АДРЕССЕРВЕРА ) + ":" + ALLTRIM( ПОРТСЕРВЕРА ) + mURL );			ФАЙЛЗАПИСАТЬСТРОКУ( ФайлОшибки, "Ответ УТМ: " + ПЕРЕКОДИРОВАТЬ( HTTPResponse, "UTF-8", "ANSI" ) );			ФАЙЛЗАПИСАТЬСТРОКУ( ФайлОшибки, СтрокаДляОтправки );			ФАЙЛЗАКРЫТЬ( ФайлОшибки );						IF ( СООБЩЕНИЕ( "При " + ИмяОперации + " файла" + CHR( 13 ) + mURL + CHR( 13 ) + "сервер вернул собщение об ошибке." + CHR( 13 ) + CHR( 13 ) + СообщениеОбОшибке + CHR( 13 ) + ПЕРЕКОДИРОВАТЬ( HTTPResponse, "UTF-8", "ANSI" ) + CHR( 13 ) + CHR( 13 ) + "Показать отправляемый текст?", "Отправка документа", 4 ) == 6 )				СООБЩЕНИЕ( "URL: " + mURL + CHR( 13 ) + ПЕРЕКОДИРОВАТЬ( СтрокаДляОтправки, "UTF-8", "ANSI" ) );			RETURN false;		}		ELSE IF ( ALLTRIM( UPPER( Команда ) ) == "DELETE" )			ИмяОперации	= "удалении";		СООБЩЕНИЕ( "При " + ИмяОперации + " файла" + CHR( 13 ) + mURL + CHR( 13 ) + "сервер вернул собщение об ошибке." + CHR( 13 ) + СообщениеОбОшибке + CHR( 13 ) + ПЕРЕКОДИРОВАТЬ( HTTPResponse, "UTF-8", "ANSI" ), "Загрузка документа" );		RETURN false;	}	// GET должен возвращать результат. Дргуие команды не обязательно	ELSE IF ( ALLTRIM( UPPER( Команда ) ) == "GET" )	{		СООБЩЕНИЕ( "Нет данных для загрузки. URL " + mURL, "Загрузка документа" );		RETURN false;	}}RETURN true;
