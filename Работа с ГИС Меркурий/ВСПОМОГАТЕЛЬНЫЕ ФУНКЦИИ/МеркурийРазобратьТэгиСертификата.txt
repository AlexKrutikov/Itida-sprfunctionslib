IF ( ТипТэга == "КОНЕЦАТРИБУТОВ" ){/*	файл= файлоткрыть( "d:\данные.txt", 1, 2 );	ФАЙЛУСТАНОВИТЬУКАЗАТЕЛЬ( файл, 0, 0, 2 );	файлзаписатьстроку( файл, "++++++++++");	файлзаписатьстроку( файл, "state= " + currentstate);	файлзаписатьстроку( файл, "substate= " + currentsubstate);	файлзаписатьстроку( файл, "tagname= " + Имя);	файлзаписатьстроку( файл, "value= " + Значение);	файлзаписатьстроку( файл, "++++++++++");	файлзакрыть( файл );*/	IF ( Имя == "vd:vetDocument" )	{		ДОБАВИТЬСТРОКИ( 1, "Сертификаты" );		currentState		= "vetDocument";		currentsubstate		= "";		waybill_type_min	= 99;	}	ELSE IF ( currentState == "vetDocument" AND Имя == "vd:certifiedConsignment" )	{		currentState		= "certifiedConsignment";		currentsubstate		= "";	}	ELSE IF ( Имя == "vd:authentication" )	{		currentState		= "authentication";		currentsubstate		= "";		authentication		= "";	}	ELSE IF ( currentState == "authentication" AND Имя != "bs:uuid" )	{		authentication		+= "<" + Имя + АТРИБУТЫ + ">";	}	ELSE IF ( currentState == "certifiedConsignment" AND Имя == "vd:consignor" )	{		currentState		= "consignor";		currentsubstate		= "";		consignor			= "";	}	ELSE IF ( currentState == "certifiedConsignment" AND Имя == "vd:consignee" )	{		currentState		= "consignee";		currentsubstate		= "";		consignee			= "";	}	ELSE IF ( currentState == "certifiedConsignment" AND Имя == "vd:broker" )	{		currentState		= "broker";		currentsubstate		= "";		broker				= "";	}	ELSE IF ( currentState == "certifiedConsignment" AND ( Имя == "vd:transportInfo" || Имя == "vd:nextTransport" ) )	{		currentState		= "transportInfo";		transportInfo		= "";	}	ELSE IF ( currentState == "certifiedConsignment" AND Имя == "vd:batch" )	{		currentState		= "product";		currentsubstate		= "";		product				= "";	}	ELSE IF ( currentState == "" AND Имя == "vd:referencedDocument" )	{		currentState		= "referencedDocument";		waybill				= "";		waybill_number		= "";		waybill_type		= "";	}	ELSE IF ( currentState == "" AND Имя == "vd:purpose" )		currentState		= "purpose";	ELSE IF ( currentState == "consignor" AND Имя != "bs:uuid" )		consignor			+= "<" + Имя + АТРИБУТЫ + ">";	ELSE IF ( currentState == "consignee" AND Имя != "bs:uuid" )		consignee			+= "<" + Имя + АТРИБУТЫ + ">";	ELSE IF ( currentState == "broker" AND Имя != "bs:uuid" )		broker				+= "<" + Имя + АТРИБУТЫ + ">";	ELSE IF ( currentState == "product" AND Имя != "bs:uuid" )	{		product				+= "<" + Имя + АТРИБУТЫ + ">";		IF ( Имя == "vd:dateOfProduction" )		{			currentsubstate	= "dateOfProduction";			origin_date		+= "<" + Имя + АТРИБУТЫ + ">";		}		ELSE IF ( Имя == "vd:expiryDate" )		{			currentsubstate	= "expiryDate";			expiry_date		+= "<" + Имя + АТРИБУТЫ + ">";		}		ELSE IF ( currentState == "product" AND currentsubstate == "dateOfProduction" )			origin_date		+= "<" + Имя + АТРИБУТЫ + ">";		ELSE IF ( currentState == "product" AND currentsubstate == "expiryDate" )			expiry_date		+= "<" + Имя + АТРИБУТЫ + ">";	}	ELSE IF ( currentState == "transportInfo" )		transportInfo		+= "<" + Имя + АТРИБУТЫ + ">";	ELSE IF ( currentState == "referencedDocument" AND Имя != "vd:relationshipType" )		waybill				+= "<" + Имя + АТРИБУТЫ + ">";	IF ( ( currentState == "consignor" OR currentState == "consignee" ) AND Имя == "dt:businessEntity" )		currentsubstate		= "businessEntity";	ELSE IF ( ( currentState == "consignor" OR currentState == "consignee" ) AND Имя == "dt:enterprise" )		currentsubstate		= "enterprise";	ELSE IF ( currentState == "product" AND Имя == "vd:product" )		currentsubstate		= "product";	ELSE IF ( currentState == "product" AND Имя == "vd:subProduct" )		currentsubstate		= "subProduct";	ELSE IF ( currentState == "product" AND Имя == "vd:productItem" )		currentsubstate		= "productItem";	ELSE IF ( currentState == "product" AND Имя == "vd:unit" )		currentsubstate		= "unit";	ELSE IF ( currentState == "product" AND Имя == "vd:origin" )		currentsubstate		= "origin";	ELSE IF ( currentState == "origin" AND Имя == "vd:producer" )		currentsubstate		= "originproducer";	ELSE IF ( currentState == "origin" AND Имя == "vd:country" )		currentsubstate		= "origincountry";	ELSE IF ( currentState == "origin" AND Имя == "vd:productItem" )		currentsubstate		= "originproductitem";			АТРИБУТЫ 				= "";}ELSE IF ( ТипТэга == "ТЭГ" AND ФлагЗакрытия ){/*			файл= файлоткрыть( "d:\данные.txt", 1, 2 );	ФАЙЛУСТАНОВИТЬУКАЗАТЕЛЬ( файл, 0, 0, 2 );	файлзаписатьстроку( файл, "**********");	файлзаписатьстроку( файл, "state= " + currentstate);	файлзаписатьстроку( файл, "substate= " + currentsubstate);	файлзаписатьстроку( файл, "tagname= " + Имя);	файлзаписатьстроку( файл, "value= " + Значение);	файлзаписатьстроку( файл, "**********");	файлзакрыть( файл );*/			IF ( Имя == "vd:vetDocument" )	{		currentState		= "";		consignor			= "";		consignee			= "";		broker				= "";		product				= "";		origin_date			= "";		expiry_date			= "";		certificate			= "";		uuid				= "";		currentstate		= "";		currentsubstate		= "";		issueDate			= {};		issueNumber			= '';		authentication		= "";	}	ELSE IF ( Имя == "vd:vetDStatus" )		REPLACE( "Сертификаты", "vetDStatus", Значение );	ELSE IF ( currentState == "certifiedConsignment" AND Имя == "vd:certifiedConsignment" )	{		currentState		= "";	}	ELSE IF ( currentState == "authentication" AND Имя == "vd:authentication" )	{		currentState		= "";		REPLACE( "Сертификаты", "authentication", authentication );	}	ELSE IF ( currentState == "authentication" AND Имя != "bs:uuid" )	{		authentication		+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";	}	ELSE IF ( currentState == "consignor" )	{		IF ( Имя == "vd:consignor" )		{			currentState	= "certifiedConsignment";			REPLACE( "Сертификаты", "consignor", consignor );		}		ELSE 		{			if ( Имя != "bs:uuid" )				consignor	+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";			IF ( currentsubstate == "businessEntity" AND Имя == "bs:guid" )				REPLACE( "Сертификаты", "consignor_be", Значение );			ELSE IF ( currentsubstate == "enterprise" AND Имя == "bs:guid" )				REPLACE( "Сертификаты", "consignor_ent", Значение );		}	}	ELSE IF ( currentState == "consignee" )	{		IF ( Имя == "vd:consignee" )		{			currentState	= "certifiedConsignment";			REPLACE( "Сертификаты", "consignee", consignee );		}		ELSE 		{			if ( Имя != "bs:uuid" )				consignee		+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";			IF ( currentsubstate == "businessEntity" AND Имя == "bs:guid" )				REPLACE( "Сертификаты", "consignee_be", Значение );			ELSE IF ( currentsubstate == "enterprise" AND Имя == "bs:guid" )				REPLACE( "Сертификаты", "consignee_ent", Значение );		}	}	ELSE IF ( currentState == "broker" )	{		IF ( Имя == "vd:broker" )		{			currentState	= "certifiedConsignment";			REPLACE( "Сертификаты", "broker", broker );		}		ELSE 		{			if ( Имя != "bs:uuid" )				broker			+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";		}	}	ELSE IF ( currentState == "transportInfo" )	{		IF ( Имя == "vd:transportInfo" || Имя == "vd:nextTransport" )		{			currentState	= "certifiedConsignment";			REPLACE( "Сертификаты", "transportInfo", transportInfo );		}		ELSE 			transportInfo	+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";	}	ELSE IF ( currentState == "referencedDocument" )	{		IF ( Имя == "vd:referencedDocument" )		{			currentState	= "";			IF ( VAL( waybill_type ) <= waybill_type_min )			{				REPLACE( "Сертификаты", "waybill", waybill );				REPLACE( "Сертификаты", "waybill_number", waybill_number );				waybill_type_min	= VAL( waybill_type );			}		}		ELSE IF ( Имя != "vd:relationshipType" )		{			waybill			+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";			IF ( Имя == "vd:issueNumber" )				waybill_number	= Значение;			IF ( Имя == "vd:type" )				waybill_type	= Значение;		}	}	ELSE IF ( Имя == "vd:transportStorageType" )	{		REPLACE( "Сертификаты", "transportStorageType", ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) );	}	ELSE IF ( currentState == "product" AND Имя == "vd:batch" )	{		currentState		= "certifiedConsignment";		REPLACE( "Сертификаты", "product", product );	}	ELSE IF ( currentState == "vetDocument" AND Имя == "bs:uuid" )		REPLACE( "Сертификаты", "certificate", Значение );	ELSE IF ( currentState == "vetDocument" AND Имя == "vd:issueDate" )		REPLACE( "Сертификаты", "issueDate", CTOD( Значение, 7 ) );	ELSE IF ( currentState == "vetDocument" AND Имя == "vd:issueNumber" )		REPLACE( "Сертификаты", "issueNumber", Значение );	ELSE IF ( currentState == "purpose" AND Имя == "bs:guid" )		REPLACE( "Сертификаты", "purpose", Значение );	ELSE IF ( currentState == "purpose" AND Имя == "vd:purpose" )		currentState 		= "";	ELSE IF ( currentState == "" AND Имя == "vd:locationProsperity" )		REPLACE( "Сертификаты", "locationProsperity", ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) );	ELSE IF ( currentState == "product" AND Имя != "bs:uuid" )	{		IF ( Имя == "vd:productType" )			REPLACE( "Сертификаты", "product_type", Значение );		ELSE IF ( Имя == "vd:volume" )			REPLACE( "Сертификаты", "productitem_volume", Значение );		ELSE IF ( currentsubstate == "product" AND Имя == "bs:guid" )			REPLACE( "Сертификаты", "product_guid", Значение );		ELSE IF ( currentsubstate == "subProduct" AND Имя == "bs:guid" )			REPLACE( "Сертификаты", "subproduct_guid", Значение );		ELSE IF ( ( currentsubstate == "productItem" OR currentsubstate == "originproductitem" ) AND Имя == "dt:name" )			REPLACE( "Сертификаты", "productitem_name", Значение );		ELSE IF ( ( currentsubstate == "productItem" OR currentsubstate == "originproductitem" ) AND Имя == "bs:guid" )			REPLACE( "Сертификаты", "productitem_guid", Значение );		ELSE IF ( ( currentsubstate == "productItem" OR currentsubstate == "originproductitem" ) AND Имя == "dt:globalID" )			REPLACE( "Сертификаты", "productitem_gtin", Значение );		ELSE IF ( ( currentsubstate == "productItem" OR currentsubstate == "originproductitem" ) AND Имя == "dt:code" )			REPLACE( "Сертификаты", "productitem_code", Значение );		ELSE IF ( currentsubstate == "unit" AND Имя == "bs:guid" )			REPLACE( "Сертификаты", "productitem_unit", Значение );		ELSE IF ( currentsubstate == "originproducer" AND Имя == "bs:guid" )			REPLACE( "Сертификаты", "productitem_producer", Значение );		ELSE IF ( currentsubstate == "origincountry" AND Имя == "bs:guid" )			REPLACE( "Сертификаты", "productitem_country", Значение );		ELSE IF ( currentState == "product" AND Имя == "vd:dateOfProduction" )		{			currentsubstate		= "";			origin_date			+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";			REPLACE( "Сертификаты", "origin_date", origin_date );		}		ELSE IF ( currentState == "product" AND Имя == "vd:expiryDate" )		{			currentsubstate		= "";			expiry_date			+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";			REPLACE( "Сертификаты", "expiry_date", expiry_date );		}		ELSE IF ( ( Имя == "vd:producer" OR Имя == "vd:country" OR Имя == "vd:productItem" ) AND LEFT( currentsubstate, 6 ) == "origin" )			currentsubstate		= "origin";		ELSE IF ( currentState == "product" AND currentsubstate == "dateOfProduction" )			origin_date			+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";		ELSE IF ( currentState == "product" AND currentsubstate == "expiryDate" )			expiry_date			+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";		ELSE IF ( Имя == "vd:product" OR Имя == "vd:subProduct" OR Имя == "vd:productItem" OR Имя == "vd:unit" )			currentsubstate		= "";		product				+= ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + "</" + Имя + ">";	}}ELSE IF ( ТипТэга == "АТРИБУТ" )	АТРИБУТЫ				+= " " + Имя + "=""" + ЕГАИС.ЗаменитьСимволы( ALLTRIM( Значение ) ) + """";ELSE IF ( ТипТэга == "НАЧАЛОАТРИБУТОВ" )	АТРИБУТЫ				= "";
