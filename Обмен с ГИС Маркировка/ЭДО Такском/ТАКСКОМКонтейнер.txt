МетаФайл	= Маркировка.ТАКСКОМMeta( ИмяТаблицы, СЕРТИФИКАТ, GUIDДокумента );
IF ( ПУСТО( МетаФайл ) ) RETURN false;

ZipФайл		= АрхивОткрыть( );
АРХИВ( ZipФайл, "ДОБАВИТЬФАЙЛ", "meta.xml", МАССИВИЗСТРОКИ( МетаФайл ) );

ДОБАВИТЬКОНТЕКСТ( "SELECT filename, signname, type, content, signcontent FROM " + ИмяТаблицы + " ORDER BY type", "СписокДокументов" );
ПОКА ( !КОНЕЦКОНТЕКСТА( "СписокДокументов" ) )
{
	// Необходимо подписать content и добавить его обратно в таблицу
	АРХИВ( ZipФайл, "ДОБАВИТЬФАЙЛ", СписокДокументов.type + "/" );
	АРХИВ( ZipФайл, "ДОБАВИТЬФАЙЛ", СписокДокументов.type + "/" + СписокДокументов.filename, СписокДокументов.content ); 
	IF ( !ПУСТО( СписокДокументов.signname ) ) 
		АРХИВ( ZipФайл, "ДОБАВИТЬФАЙЛ", СписокДокументов.type + "/" + СписокДокументов.signname, СписокДокументов.signcontent ); 
	ПРОПУСТИТЬ( 1, "СписокДокументов" );
}
УДАЛИТЬКОНТЕКСТ( "СписокДокументов" );

Контейнер	= АрхивЗакрыть( ZipФайл );
//Файл		= ФАЙЛСОЗДАТЬ( "D:\Контейнер.zip" );
//ФАЙЛЗАПИСАТЬ( Файл, Контейнер );
//ФАЙЛЗАКРЫТЬ( Файл );
RETURN Контейнер;
