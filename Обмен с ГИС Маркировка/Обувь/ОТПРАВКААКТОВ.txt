//------ Читаем документы из локальной таблицы
ДОБАВИТЬКОНТЕКСТ( "SELECT guid, ic FROM " + ИМЯТАБЛИЦЫ, "СписокДокументов" );
IF ( КОЛИЧЕСТВОСТРОК( "СписокДокументов" ) == 0 )
	СООБЩЕНИЕ( "Не было отмечено ни одного документа в списке." );

ПОКА ( !КОНЕЦКОНТЕКСТА( "СписокДокументов" ) )
{
	Статус	= ЗАПРОС( "SELECT status FROM mark_in WHERE identity_column = " + СписокДокументов.ic );
	IF ( Статус == 0 )
		МАРКИРОВКА.ОТПРАВКААКТА( ПРЕДПРИЯТИЕ, СписокДокументов.ic );
	ELSE IF ( !ПУСТО( СписокДокументов.guid ) )
		МАРКИРОВКА.ПРОВЕРКАСТАТУСАДОКУМЕНТА( ПРЕДПРИЯТИЕ, СписокДокументов.guid, "actguid" );
	
	ОЖИДАНИЕ( 500 );
	ПРОПУСТИТЬ( 1, "СписокДокументов" );
}
УДАЛИТЬКОНТЕКСТ( "СписокДокументов" );
