
// Запрашиваем имя файла для загрузки
ИмяФайла		= ФАЙЛВЫБРАТЬ( 1, "Файлы XML и CSV|*.xml;*.csv" );
IF ( ПУСТО( ИмяФайла ) ) RETURN false;

IF ( UPPER( ПРАВСИМВ( ИмяФайла, 3 ) ) == "CSV" )
{
	IF ( !Маркировка.СоздатьДокументИЗCSV( Предприятие, ИмяФайла ) ) 
		RETURN false;
}
ELSE
{
	Файл					= ФАЙЛОТКРЫТЬ( ИмяФайла );
	IF ( Файл < 0 ) 
	{
		СООБЩЕНИЕ( "Не удалось открыть файл '" + ИмяФайла + "' для загрузки данных." );
		RETURN "";
	}
	СодержимоеФайла			= ФАЙЛПРОЧИТАТЬ( Файл, "S", ФАЙЛРАЗМЕР( Файл ) );
	ФАЙЛЗАКРЫТЬ( Файл );
	IF ( ПУСТО( Маркировка.СоздатьДокументИЗXML( Предприятие, GUIDДокумента, "", СодержимоеФайла, true ) ) )
		RETURN false;
}

//-------- Переименовываем файл, чтобы не мешал
ФАЙЛПЕРЕИМЕНОВАТЬ( ИмяФайла, ИмяФайла + ".bak" );
