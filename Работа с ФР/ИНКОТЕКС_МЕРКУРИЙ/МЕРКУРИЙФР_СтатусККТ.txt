// Печать прочих отчетов
// Получение статуса

// Параметры - 
// КодСтатуса строка, определяющая статус, значение которого необходимо вернуть.

Статус = 0;
IF ( КодСтатуса == "SESSION" OR КодСтатуса == "SESSIONOPENED" )
{
	IF ( !ФР.МЕРКУРИЙФР_ОткрытьСессию( КОДОБОРУДОВАНИЯ, "Статус ККТ" ) ) RETURN false;
			
	ОтветСостояниеККТ = ФР.МЕРКУРИЙФР_ПолучениеСостоянияККТ();
	
	IF ( ПУСТО( ОтветСостояниеККТ ) )
		RETURN Статус;
	
	
	СменаОткрыта	= ПОЛЕ_JSON( ПОЛЕ_JSON( ОтветСостояниеККТ, "shiftInfo", "" ), "isOpen", "" ) == "true";
	СменаПревысила24Часа	= ПОЛЕ_JSON( ПОЛЕ_JSON( ОтветСостояниеККТ, "shiftInfo", "" ), "is24Expired", "" ) == "true";
	НомерСменыККМ	= ПОЛЕ_JSON( ПОЛЕ_JSON( ОтветСостояниеККТ, "shiftInfo", "" ), "num", "" ) + ЕСЛИ( !СменаОткрыта , 1, 0 );
	НомерЧекаККМ	= ПОЛЕ_JSON( ПОЛЕ_JSON( ПОЛЕ_JSON( ОтветСостояниеККТ, "fnInfo", "" ), "lastDoc", "" ), "num", "" );
	
	IF ( КодСтатуса == "SESSION" )
		Статус 		= НомерСменыККМ;
	ELSE
	{
		IF ( СменаПревысила24Часа )
		{
			СООБЩЕНИЕ("ККМ """ + ФР.ИмяОборудования() + """: Смена превысила 24 часа." + CHR(13) + "Необходимо произвести закрытие смены.");
		}
		Статус 		= СменаОткрыта <> "false" AND СменаОткрыта <> false;
	}
	
	IF ( !ФР.МЕРКУРИЙФР_ЗакрытьСессию( КОДОБОРУДОВАНИЯ, "Статус ККТ" ) ) RETURN false;
}

RETURN Статус;
