
ДОБАВИТЬКОНТЕКСТ( "SELECT doc.*, client.inn AS clientinn, client.name AS clientname, client.kpp AS clientkpp, 
						  firm.inn AS firminn, firm.name AS firmname, firm.kpp AS firmkpp, firm.dir_empl, firm.dir_title, firm.ogrn AS firmogrn,
						  firm.postcode AS firmpostcode, LEFT( CASE WHEN firm.kpp <> '' THEN firm.kpp ELSE firm.inn END, 2 ) AS firmregion, 
						  firm.city AS firmcity, firm.street AS firmstreet, firm.building AS firmbuilding, firm.telefon AS firmtelefon,
						  firmempl.firstname AS firmfirstname, 
						  (SELECT name FROM sprsimple WHERE code = firmempl.midname ) AS firmmidname, 
						  (SELECT name FROM sprsimple WHERE code = firmempl.lastname ) AS firmlastname,

						  client.postcode AS clientpostcode, LEFT( CASE WHEN client.kpp <> '' THEN client.kpp ELSE client.inn END, 2 ) AS clientregion, 
						  client.city AS clientcity, client.street AS clientstreet, client.building AS clientbuilding, client.telefon AS clienttelefon,
						  client.rs AS clientrs, 

						  firmbank.name AS firmbankname, firmbank.mfo AS firmbankmfo,
						  clientbank.name AS clientbankname, clientbank.mfo AS clientbankmfo,
						  LEFT( client.fio, CHARINDEX( ' ', client.fio ) ) AS clientfirstname, 
						  CASE WHEN CHARINDEX( ' ', client.fio, CHARINDEX( ' ', client.fio ) + 1 ) > 0 THEN SUBSTRING( client.fio, CHARINDEX( ' ', client.fio ) + 1, CHARINDEX( ' ', client.fio, CHARINDEX( ' ', client.fio ) + 1 ) - CHARINDEX( ' ', client.fio ) - 1 ) ELSE '' END AS clientmidname, 
						  CASE WHEN CHARINDEX( ' ', client.fio, CHARINDEX( ' ', client.fio ) + 1 ) > 0 THEN SUBSTRING( client.fio, CHARINDEX( ' ', client.fio, CHARINDEX( ' ', client.fio ) + 1 ) + 1,  100 ) ELSE '' END AS clientlastname, 

						  dbo.fn_getchar_ex( 'SPR', 'S30', 'НаименованиеЭДО', firm, 0, 0, '' ) AS firmedoname, 
						  dbo.fn_getchar_ex( 'SPR', 'S30', 'ИННЭДО', firm, 0, 0, '' ) AS firmedoinn, 
						  dbo.fn_getchar_ex( 'SPR', 'S30', 'КодЭДО', firm, 0, 0, '' ) AS firmedo, 
						  dbo.fn_getchar_ex( 'SPR', 'S01', 'КодЭДО', client, 0, 0, '' ) AS clientedo

				   FROM spr002 doc
				   LEFT OUTER JOIN sprfirm firm ON doc.firm = firm.code
				   LEFT OUTER JOIN sprempl firmempl ON firm.dir_empl = firmempl.code
				   LEFT OUTER JOIN sprclient client ON doc.client = client.code
				   LEFT OUTER JOIN sprrs rs ON doc.rs = rs.code 
				   LEFT OUTER JOIN sprbank firmbank ON rs.bank = firmbank.code
				   LEFT OUTER JOIN sprbank clientbank ON client.bank = clientbank.code
				   WHERE doc.identity_column = " + ИДДокумента, "Документ" );
ДОБАВИТЬКОНТЕКСТ( "EXEC sp_docspec '002', " + ИДДокумента, "Спецификация" );

// К имени файла добавляем путь
ПутьКФайлу				= ALLTRIM( ПутьКФайлу );
IF ( RIGHT( ПутьКФайлу, 1 ) != "\" ) ПутьКФайлу+= "\";

GUID					= ЗАПРОС( "SELECT NEWID( )" );
ИмяФайла				= ПутьКФайлу + 'ON_SCHFDOPPR_' + Документ.clientedo + '_' + Документ.firmedo + "_" + DTOC( ДАТА( ), 7, "" ) + "_" + GUID;
Файл					= ФАЙЛСОЗДАТЬ( ИмяФайла + ".xml", 0 );

// Стандартный заголовок XML. Кодировка 1251
ФАЙЛЗАПИСАТЬСТРОКУ( Файл, "<?xml version=""1.0"" encoding=""windows-1251""?>" );
АТРИБУТЫИМЯ[ 0 ] 		= "ИдФайл";
АТРИБУТЫИМЯ[ 1 ] 		= "ВерсФорм";
АТРИБУТЫИМЯ[ 2 ] 		= "ВерсПрог";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= ИмяФайла;
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= "5.02";
АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= "Itida";
ЭДО.ЗаписатьНачалоТЭГа( Файл, 0, "Файл", 3 );
АТРИБУТЫИМЯ[ 0 ] 		= "ИдОтпр";
АТРИБУТЫИМЯ[ 1 ] 		= "ИдПол";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firmedo;
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.clientedo;
ЭДО.ЗаписатьНачалоТЭГа( Файл, 1, "СвУчДокОбор", 2 );
АТРИБУТЫИМЯ[ 0 ] 		= "НаимОрг";
АТРИБУТЫИМЯ[ 1 ] 		= "ИННЮЛ";
АТРИБУТЫИМЯ[ 2 ] 		= "ИдЭДО";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firmedoname;
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.firmedoinn;
АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= LEFT( Документ.firmedo, 3 );
ЭДО.ЗаписатьТЭГ( Файл, 2, "СвОЭДОтпр", "", 3 );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 1, "СвУчДокОбор" );

АТРИБУТЫИМЯ[ 0 ] 		= "КНД";
АТРИБУТЫИМЯ[ 1 ] 		= "Функция";
АТРИБУТЫИМЯ[ 2 ] 		= "ПоФактХЖ";
АТРИБУТЫИМЯ[ 3 ] 		= "НаимДокОпр";
АТРИБУТЫИМЯ[ 4 ] 		= "ДатаИнфПр";
АТРИБУТЫИМЯ[ 5 ] 		= "ВремИнфПр";
АТРИБУТЫИМЯ[ 6 ] 		= "НаимЭконСубСост";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= "1115125";
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= "СЧФ";
АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= "Документ об отгрузке товаров (выполнении работ), передаче имущественных прав (документ об оказании услуг)";
АТРИБУТЫЗНАЧЕНИЕ[ 3 ] 	= "Документ об отгрузке товаров (выполнении работ), передаче имущественных прав (Документ об оказании услуг)";
АТРИБУТЫЗНАЧЕНИЕ[ 4 ] 	= DTOC( ДАТА( ), 4, "." );
АТРИБУТЫЗНАЧЕНИЕ[ 5 ] 	= ALLTRIM( ЗАМЕНИТЬ( TTOC( ДАТА( ), 8 ), ":", "." ) );
АТРИБУТЫЗНАЧЕНИЕ[ 6 ] 	= Документ.firmname;
ЭДО.ЗаписатьНачалоТЭГа( Файл, 1, "Документ", 7 );

АТРИБУТЫИМЯ[ 0 ] 		= "НомерСчФ";
АТРИБУТЫИМЯ[ 1 ] 		= "ДатаСчФ";
АТРИБУТЫИМЯ[ 2 ] 		= "КодОКВ";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.ndok;
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= DTOC( Документ.date, 4, "." );
АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= "643";
ЭДО.ЗаписатьНачалоТЭГа( Файл, 1, "СвСчФакт", 3 );

////// Продавец
ЭДО.ЗаписатьНачалоТЭГа( Файл, 2, "СвПрод", 0 );
ЭДО.ВыгрузитьИДСВ( Документ.firminn, Документ.firmkpp, Документ.firmname, Документ.firmfirstname, Документ.firmmidname, Документ.firmlastname );

ЭДО.ЗаписатьНачалоТЭГа( Файл, 3, "Адрес", 0 );
АТРИБУТЫИМЯ[ 0 ] 		= "Индекс";
АТРИБУТЫИМЯ[ 1 ] 		= "КодРегион";
АТРИБУТЫИМЯ[ 2 ] 		= "Город";
АТРИБУТЫИМЯ[ 3 ] 		= "Улица";
АТРИБУТЫИМЯ[ 4 ] 		= "Дом";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firmpostcode;
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.firmregion;
АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= Документ.firmcity;
АТРИБУТЫЗНАЧЕНИЕ[ 3 ] 	= Документ.firmstreet;
АТРИБУТЫЗНАЧЕНИЕ[ 4 ] 	= Документ.firmbuilding;
ЭДО.ЗаписатьТЭГ( Файл, 4, "АдрРФ", "", 5 );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "Адрес" );

АТРИБУТЫИМЯ[ 0 ] 		= "Тлф";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firmtelefon;
ЭДО.ЗаписатьТЭГ( Файл, 3, "Контакт", "", 1 );

АТРИБУТЫИМЯ[ 0 ] 		= "НомерСчета";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.rs;
ЭДО.ЗаписатьНачалоТЭГа( Файл, 3, "БанкРекв", 1 );

АТРИБУТЫИМЯ[ 0 ] 		= "НаимБанк";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firmbankname;
АТРИБУТЫИМЯ[ 1 ] 		= "БИК";
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.firmbankmfo;
ЭДО.ЗаписатьТЭГ( Файл, 4, "СвБанк", "", 2 );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "БанкРекв" );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 2, "СвПрод" );

////// Грузоотрпавитель (он же)
ЭДО.ЗаписатьНачалоТЭГа( Файл, 2, "ГрузОт", 0 );
ЭДО.ЗаписатьНачалоТЭГа( Файл, 3, "ГрузОтпр", 0 );
ЭДО.ВыгрузитьИДСВ( Документ.firminn, Документ.firmkpp, Документ.firmname, Документ.firmfirstname, Документ.firmmidname, Документ.firmlastname );

ЭДО.ЗаписатьНачалоТЭГа( Файл, 4, "Адрес", 0 );
АТРИБУТЫИМЯ[ 0 ] 		= "Индекс";
АТРИБУТЫИМЯ[ 1 ] 		= "КодРегион";
АТРИБУТЫИМЯ[ 2 ] 		= "Город";
АТРИБУТЫИМЯ[ 3 ] 		= "Улица";
АТРИБУТЫИМЯ[ 4 ] 		= "Дом";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firmpostcode;
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.firmregion;
АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= Документ.firmcity;
АТРИБУТЫЗНАЧЕНИЕ[ 3 ] 	= Документ.firmstreet;
АТРИБУТЫЗНАЧЕНИЕ[ 4 ] 	= Документ.firmbuilding;
ЭДО.ЗаписатьТЭГ( Файл, 5, "АдрРФ", "", 5 );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 4, "Адрес" );

АТРИБУТЫИМЯ[ 0 ] 		= "Тлф";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firmtelefon;
ЭДО.ЗаписатьТЭГ( Файл, 4, "Контакт", "", 1 );

АТРИБУТЫИМЯ[ 0 ] 		= "НомерСчета";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.rs;
ЭДО.ЗаписатьНачалоТЭГа( Файл, 4, "БанкРекв", 1 );

АТРИБУТЫИМЯ[ 0 ] 		= "НаимБанк";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firmbankname;
АТРИБУТЫИМЯ[ 1 ] 		= "БИК";
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.firmbankmfo;
ЭДО.ЗаписатьТЭГ( Файл, 5, "СвБанк", "", 2 );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 4, "БанкРекв" );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "ГрузОтпр" );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 2, "ГрузОт" );

////// Покупатель
ЭДО.ЗаписатьНачалоТЭГа( Файл, 2, "СвПокуп", 0 );
ЭДО.ВыгрузитьИДСВ( Документ.clientinn, Документ.clientkpp, Документ.clientname, Документ.clientfirstname, Документ.clientmidname, Документ.clientlastname );

ЭДО.ЗаписатьНачалоТЭГа( Файл, 3, "Адрес", 0 );
АТРИБУТЫИМЯ[ 0 ] 		= "Индекс";
АТРИБУТЫИМЯ[ 1 ] 		= "КодРегион";
АТРИБУТЫИМЯ[ 2 ] 		= "Город";
АТРИБУТЫИМЯ[ 3 ] 		= "Улица";
АТРИБУТЫИМЯ[ 4 ] 		= "Дом";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.clientpostcode;
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.clientregion;
АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= Документ.clientcity;
АТРИБУТЫЗНАЧЕНИЕ[ 3 ] 	= Документ.clientstreet;
АТРИБУТЫЗНАЧЕНИЕ[ 4 ] 	= Документ.clientbuilding;
ЭДО.ЗаписатьТЭГ( Файл, 4, "АдрРФ", "", 5 );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "Адрес" );

АТРИБУТЫИМЯ[ 0 ] 		= "Тлф";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.clienttelefon;
ЭДО.ЗаписатьТЭГ( Файл, 3, "Контакт", "", 1 );

АТРИБУТЫИМЯ[ 0 ] 		= "НомерСчета";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.clientrs;
ЭДО.ЗаписатьНачалоТЭГа( Файл, 3, "БанкРекв", 1 );

АТРИБУТЫИМЯ[ 0 ] 		= "НаимБанк";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.clientbankname;
АТРИБУТЫИМЯ[ 1 ] 		= "БИК";
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.clientbankmfo;
ЭДО.ЗаписатьТЭГ( Файл, 4, "СвБанк", "", 2 );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "БанкРекв" );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 2, "СвПокуп" );

АТРИБУТЫИМЯ[ 0 ] 		= "НаимОКВ";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= "Российский рубль";
ЭДО.ЗаписатьТЭГ( Файл, 3, "ДопСвФХЖ1", "", 1 );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 1, "СвСчФакт" );

ИтогоБезНДС				= 0.00;
ИтогоСумма				= 0.00;
ИтогоНДС				= 0.00;

ЭДО.ЗаписатьНачалоТЭГа( Файл, 2, "ТаблСчФакт", 0 );
ВЫБРАТЬКОНТЕКСТ( "Спецификация" );
WHILE ( !КОНЕЦКОНТЕКСТА( "Спецификация" ) )
{
	АТРИБУТЫИМЯ[ 0 ] 		= "НомСтр";
	АТРИБУТЫИМЯ[ 1 ] 		= "НаимТов";
	АТРИБУТЫИМЯ[ 2 ] 		= "ОКЕИ_Тов";
	АТРИБУТЫИМЯ[ 3 ] 		= "КолТов";
	АТРИБУТЫИМЯ[ 4 ] 		= "ЦенаТов";
	АТРИБУТЫИМЯ[ 5 ] 		= "СтТовБезНДС";
	АТРИБУТЫИМЯ[ 6 ] 		= "НалСт";
	АТРИБУТЫИМЯ[ 7 ] 		= "СтТовУчНал";
	АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Спецификация.npp;
	АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Спецификация.nnname;
	АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= ЗАПРОС( "SELECT ex_code FROM spredn WHERE code= '" + Спецификация.ed + "'" );
	АТРИБУТЫЗНАЧЕНИЕ[ 3 ] 	= STR( Спецификация.kolp, 16, 3 );
	АТРИБУТЫЗНАЧЕНИЕ[ 4 ] 	= STR( Спецификация.cenawonds, 16, 2 );
	АТРИБУТЫЗНАЧЕНИЕ[ 5 ] 	= STR( Спецификация.sumwonds, 16, 2 );
	АТРИБУТЫЗНАЧЕНИЕ[ 6 ] 	= ЕСЛИ( Спецификация.procnds <> 0, STR( Спецификация.procnds ) + "%", "без НДС" );
	АТРИБУТЫЗНАЧЕНИЕ[ 7 ] 	= STR( Спецификация.summa, 16, 2 );
	ЭДО.ЗаписатьНачалоТЭГа( Файл, 3, "СведТов", 8 );
	ЭДО.ЗаписатьНачалоТЭГа( Файл, 4, "Акциз", 0 );
	ЭДО.ЗаписатьТЭГ( Файл, 4, "БезАкциз", "без акциза" );
	ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 4, "Акциз" );

	ЭДО.ЗаписатьНачалоТЭГа( Файл, 4, "СумНал", 0 );
	IF ( ROUND( Спецификация.sumnds, 2 ) != 0 )
		ЭДО.ЗаписатьТЭГ( Файл, 4, "СумНал", STR( Спецификация.sumnds, 16, 2 ) );
	ELSE
		ЭДО.ЗаписатьТЭГ( Файл, 4, "БезНДС", "без НДС" );
	ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 4, "СумНал" );
	
	Страна					= ЗАПРОС( "SELECT name FROM sprcountry WHERE code = (SELECT manuf FROM sprnn WHERE nn = '" + Спецификация.nn + "')" );
	IF ( !ПУСТО( Страна ) AND @Страна != "РОССИЯ" )
	{
		КодСтраны			= ЗАПРОС("SELECT ex_code FROM sprcountry WHERE code = (SELECT manuf FROM sprnn WHERE nn = '" + Спецификация.nn + "')" );
		ГТД					= ЗАПРОС( "SELECT declar FROM sprres WHERE code = '" + Спецификация.nn + "'" );
		
		АТРИБУТЫИМЯ[ 0 ] 		= "КодПроисх";
		АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= КодСтраны;
		АТРИБУТЫИМЯ[ 1 ] 		= "НомерТД";
		АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= ГТД;
		ЭДО.ЗаписатьТЭГ( Файл, 4, "СвТД", "", 2 );
	}

	АТРИБУТЫИМЯ[ 0 ] 		= "НаимЕдИзм";
	АТРИБУТЫИМЯ[ 1 ] 		= "КодТов";
	АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Спецификация.ed;
	АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= ЗАПРОС( "SELECT maincode FROM sprres WHERE code = '" + ЕСЛИ( ПУСТО( Спецификация.nn ), Спецификация.s_code, Спецификация.nn ) + "'" );;
	ЭДО.ЗаписатьТЭГ( Файл, 4, "ДопСведТов", "", 2 );
	ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "СведТов" );
	
	ИтогоБезНДС				+= Спецификация.sumwonds;
	ИтогоСумма				+= Спецификация.summa;
	ИтогоНДС				+= Спецификация.sumnds;
	ПРОПУСТИТЬ( 1, "Спецификация" );
}
АТРИБУТЫИМЯ[ 0 ] 		= "СтТовБезНДСВсего";
АТРИБУТЫИМЯ[ 1 ] 		= "СтТовУчНалВсего";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= STR( ИтогоБезНДС, 16, 2 );
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= STR( ИтогоСумма, 16, 2 );
ЭДО.ЗаписатьНачалоТЭГа( Файл, 3, "ВсегоОпл", 2 );
ЭДО.ЗаписатьНачалоТЭГа( Файл, 4, "СумНалВсего" );
ЭДО.ЗаписатьТЭГ( Файл, 5, "СумНал", STR( ИтогоНДС, 16, 2 ) );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 4, "СумНалВсего" );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "ВсегоОпл" );

ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 2, "ТаблСчФакт" );
УДАЛИТЬКОНТЕКСТ( "Спецификация" );

ЭДО.ЗаписатьНачалоТЭГа( Файл, 2, "СвПродПер" );
АТРИБУТЫИМЯ[ 0 ] 		= "СодОпер";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= ЕСЛИ( !ПУСТО( Документ.note ), Документ.note, "Отгрузка товаров/оказание услуг." );
ЭДО.ЗаписатьНачалоТЭГа( Файл, 3, "СвПер", 1 );

ДОБАВИТЬКОНТЕКСТ( "SELECT doc.name, cl.ndok, cl.date 
				   FROM crosslink cl 
				   INNER JOIN docstab doc ON doc.code = cl.code
				   WHERE cr_code = '002' AND cr_ic = " + ИДДокумента, "Основание" );
IF ( !ПУСТО( Основание.ndok ) )
{
	АТРИБУТЫИМЯ[ 0 ] 		= "НаимОсн";
	АТРИБУТЫИМЯ[ 1 ] 		= "НомОсн";
	АТРИБУТЫИМЯ[ 2 ] 		= "ДатаОсн";
	АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Основание.name;
	АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Основание.ndok;
	АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= DTOC( Основание.date, 4, "." );
	ЭДО.ЗаписатьТЭГ( Файл, 4, "ОснПер", "", 3 );
}
ELSE
{
	АТРИБУТЫИМЯ[ 0 ] 		= "НаимОсн";
	АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= "Отсутствует";
	ЭДО.ЗаписатьТЭГ( Файл, 4, "ОснПер", "", 1 );
}

ЭДО.ЗаписатьТЭГ( Файл, 4, "ТранГруз", "" );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "СвПер" );

ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 2, "СвПродПер" );

ФамилияСотрудника		= ЗАПРОС( "SELECT firstname FROM sprempl WHERE code = '" + Документ.dir_empl + "'" );
ИмяСотрудника			= ЗАПРОС( "SELECT smp.name FROM sprempl empl inner join sprsimple smp ON empl.midname = smp.code AND smp.cat='001' WHERE empl.code = '" + Документ.dir_empl + "'" );
ОтчествоСотрудника		= ЗАПРОС( "SELECT smp.name FROM sprempl empl inner join sprsimple smp ON empl.lastname = smp.code AND smp.cat='002' WHERE empl.code = '" + Документ.dir_empl + "'" );

АТРИБУТЫИМЯ[ 0 ] 		= "ОблПолн";
АТРИБУТЫИМЯ[ 1 ] 		= "Статус";
АТРИБУТЫИМЯ[ 2 ] 		= "ОснПолн";
АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= "1";
АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= "1";
АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= "Должностные обязанности";
ЭДО.ЗаписатьНачалоТЭГа( Файл, 2, "Подписант", 3 );
IF ( LEN( Документ.firminn ) == 12 )
{
	АТРИБУТЫИМЯ[ 0 ] 		= "ИННФЛ";
	АТРИБУТЫИМЯ[ 1 ] 		= "СвГосРегИП";
	АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firminn;
	АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.firmogrn;
	ЭДО.ЗаписатьНачалоТЭГа( Файл, 2, "ИП", 2 );

	АТРИБУТЫИМЯ[ 0 ] 		= "Фамилия";
	АТРИБУТЫИМЯ[ 1 ] 		= "Имя";
	АТРИБУТЫИМЯ[ 2 ] 		= "Отчество";
	АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= ФамилияСотрудника;
	АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= ИмяСотрудника;
	АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= ОтчествоСотрудника;
	ЭДО.ЗаписатьТЭГ( Файл, 4, "ФИО", "", 3 );
	ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "ИП" );
}
ELSE
{
	АТРИБУТЫИМЯ[ 0 ] 		= "ИННЮЛ";
	АТРИБУТЫИМЯ[ 1 ] 		= "НаимОрг";
	АТРИБУТЫИМЯ[ 2 ] 		= "Должн";
	АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= Документ.firminn;
	АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= Документ.firmname;
	АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= Документ.dir_title;
	ЭДО.ЗаписатьНачалоТЭГа( Файл, 3, "ЮЛ", 3 );

	АТРИБУТЫИМЯ[ 0 ] 		= "Фамилия";
	АТРИБУТЫИМЯ[ 1 ] 		= "Имя";
	АТРИБУТЫИМЯ[ 2 ] 		= "Отчество";
	АТРИБУТЫЗНАЧЕНИЕ[ 0 ] 	= ФамилияСотрудника;
	АТРИБУТЫЗНАЧЕНИЕ[ 1 ] 	= ИмяСотрудника;
	АТРИБУТЫЗНАЧЕНИЕ[ 2 ] 	= ОтчествоСотрудника;
	ЭДО.ЗаписатьТЭГ( Файл, 4, "ФИО", "", 3 );
	ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 3, "ЮЛ" );
}
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 2, "Подписант" );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 1, "Документ" );
ЭДО.ЗаписатьОкончаниеТЭГа( Файл, 0, "Файл" );


УДАЛИТЬКОНТЕКСТ( "Документ" );
ФАЙЛЗАКРЫТЬ( Файл );
RETURN true;
