
// Запрашиваем имя файла для загрузки
ИмяФайла		= ФАЙЛВЫБРАТЬ( 1, "Файлы XML|*.xml" );
IF ( ПУСТО( ИмяФайла ) ) RETURN false;

Файл					= ФАЙЛОТКРЫТЬ( ИмяФайла );
IF ( Файл < 0 ) 
{
	СООБЩЕНИЕ( "Не удалось открыть файл '" + ИмяФайла + "' для загрузки данных." );
	RETURN "";
}
СодержимоеФайла			= ФАЙЛПРОЧИТАТЬ( Файл, "S", ФАЙЛРАЗМЕР( Файл ) );
ФАЙЛЗАКРЫТЬ( Файл );

ТИПДОКУМЕНТА		= ЕСЛИ( "DP_IAKTPRM" $ СодержимоеФайла || "DP_REZRUISP" $ СодержимоеФайла || "PP_AKT" $ СодержимоеФайла, "049", 
					  ЕСЛИ( "ON_SCHET" $ СодержимоеФайла, "032", 
					  ЕСЛИ( "DP_ORDER" $ СодержимоеФайла || "ON_ORDER" $ СодержимоеФайла, "020",  
					  ЕСЛИ( "ON_" $ СодержимоеФайла || "DP_OTORG12" $ СодержимоеФайла || 
							"DP_TOVTORGPR" $ СодержимоеФайла, "001", "" ) ) ) );

ТИПВЛОЖЕНИЯ			= ЕСЛИ( "DP_IAKTPRM" $ СодержимоеФайла, "DP_IAKTPRM",
					  ЕСЛИ( "DP_REZRUISP" $ СодержимоеФайла, "DP_REZRUISP", 
					  ЕСЛИ( "PP_AKT" $ СодержимоеФайла, "PP_AKT",  
					  ЕСЛИ( "ON_SCHET" $ СодержимоеФайла, "ON_SCHET", 
					  ЕСЛИ( "DP_ORDER" $ СодержимоеФайла, "DP_ORDER", 
					  ЕСЛИ( "ON_ORDER" $ СодержимоеФайла, "ON_ORDER", 
					  ЕСЛИ( "ON_" $ СодержимоеФайла, "ON_", 
					  ЕСЛИ( "DP_OTORG12" $ СодержимоеФайла, "DP_OTORG12", 
					  ЕСЛИ( "DP_TOVTORGPR" $ СодержимоеФайла, "DP_TOVTORGPR", "OTHER" ) ) ) ) ) ) ) ) );

IF ( ПУСТО( ЭДО.СоздатьДокументИЗXML( Предприятие, GUIDДокумента, "", СодержимоеФайла, true, ТИПДОКУМЕНТА, ТИПВЛОЖЕНИЯ ) ) )
	RETURN false;

//-------- Переименовываем файл, чтобы не мешал
ФАЙЛПЕРЕИМЕНОВАТЬ( ИмяФайла, ИмяФайла + ".bak" );
