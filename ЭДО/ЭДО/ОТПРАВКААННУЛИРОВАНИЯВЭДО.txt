// По коду предприятия необходимо определить систему ЭДО, с которой работает пользователь.// В зависимости от системы вызвать нужную функцию.РезультатОтправки		= true;СИСТЕМАЭДО				= ЗАПРОС( "SELECT value FROM param_ex WHERE param= 'EDI_EDI" + ПРЕДПРИЯТИЕ + "'" );КоличествоДокументов	= 0;IF ( !ПУСТО( ИМЯТАБЛИЦЫ ) )	ДОБАВИТЬКОНТЕКСТ( "SELECT guid, rid FROM " + ИМЯТАБЛИЦЫ, "СписокДокументов" );ELSE	ДОБАВИТЬКОНТЕКСТ( "SELECT guid, rid FROM " + ЕСЛИ( ВхолдящийДокумент, "ediincome", "edioutcome" ) + " WHERE rid= '" + РИДДОКУМЕНТА + "'", "СписокДокументов" );	IF ( КОЛИЧЕСТВОСТРОК( "СписокДокументов" ) == 0 ){	СООБЩЕНИЕ( "Не было отмечено ни одного документа в списке." );	RETURN true;}try{	ИДРедакции			= ЕСЛИ( ВходящийДокумент, ЗАПРОС( "SELECT editionguid FROM ediincome WHERE rid = '" + СписокДокументов.rid + "'" ), "" );	ПОКА ( !КОНЕЦКОНТЕКСТА( "СписокДокументов" ) )	{		IF ( СИСТЕМАЭДО == "СБИС" )		{			IF ( !ЭДО.СБИСОтправитьАннулирование( ПРЕДПРИЯТИЕ, СписокДокументов.guid, ИДРедакции, ВходящийДокумент ) ) THROW;		}		ELSE IF ( СИСТЕМАЭДО == "ТАКСКОМ" )		{			IF ( !ЭДО.ТАКСКОМОтправитьАннулирование( ПРЕДПРИЯТИЕ, СписокДокументов.rid, ВходящийДокумент ) ) THROW;		}		ПРОПУСТИТЬ( 1, "СписокДокументов" );		КоличествоДокументов++;	}}catch( ){	РезультатОтправки	= false;}СООБЩЕНИЕ( "В систему ЭДО было отправлено " + ПРОПИСЬ( КоличествоДокументов, "запрос", "запроса", "запросов" ) + " на аннулирование документов." );УДАЛИТЬКОНТЕКСТ( "СписокДокументов" );RETURN РезультатОтправки;
