	// Формируем список наклданых для отправкиДОБАВИТЬКОНТЕКСТ( "SELECT ndok, date FROM spr001 WHERE egaisvnpstatus <= 2 AND identity_column IN ( SELECT ic FROM " + ИМЯТАБЛИЦЫ + " )", "СписокДокументов" );ТекстСообщения		= "";WHILE ( !КОНЕЦКОНТЕКСТА( "СписокДокументов" ) ){	ТекстСообщения	+= СписокДокументов.ndok + " от " + DTOC( СписокДокументов.date ) + CHR( 13 );	ПРОПУСТИТЬ( 1, "СписокДокументов" );}УДАЛИТЬКОНТЕКСТ( "СписокДокументов" );IF ( !ПУСТО( ТекстСообщения ) )	IF ( СООБЩЕНИЕ( "По следующим документам еще не были отправлены перемещения в ЕГАИС. Продолжить? " + CHR( 13 ) + ТекстСообщения, "Отправка документов", 4 ) != 6 ) RETURN false;// Проходим по списку отмеченных документов и отправляем их в ЕГАИСДОБАВИТЬКОНТЕКСТ( "SELECT temp.ic, spr.egaisvnpstatus, spr.egaisact, spr.ndok, spr.date				   FROM " + ИМЯТАБЛИЦЫ + " temp				   INNER JOIN spr001 spr ON temp.ic = spr.identity_column", "СписокДокументов" );IF ( КОЛИЧЕСТВОСТРОК( "СписокДокументов" ) == 0 ){	СООБЩЕНИЕ( "Необходимо отметить хотя бы один документ, для отправки.", "Отправка документов" );	RETURN false;}ТекстСообщения		= "";WHILE ( !КОНЕЦКОНТЕКСТА( "СписокДокументов" ) ){	IF ( СписокДокументов.egaisact == 3 OR ЗАПРОС( "SELECT count(*) FROM spec001 WHERE ic = " + СписокДокументов.ic + " AND realkolp > 0 "  ) == 0 )		ТекстСообщения	+= СписокДокументов.ndok + " от " + DTOC( СписокДокументов.date ) + CHR( 13 );	ELSE IF ( !ЕГАИС.ВернутьПриходИЗМАГАЗИНА_В2( СписокДокументов.ic ) ) RETURN false;	ПРОПУСТИТЬ( 1, "СписокДокументов" );}УДАЛИТЬКОНТЕКСТ( "СписокДокументов" );IF ( !ПУСТО( ТекстСообщения ) )	СООБЩЕНИЕ( "Следующие документы не содержат данных для отправки в торговый зал ЕГАИС." + CHR( 13 ) + ТекстСообщения + CHR( 13 ) + "Перечисленные документы не были отправлены в ЕГАИС.", "Отправка документов", 0 );RETURN true;
