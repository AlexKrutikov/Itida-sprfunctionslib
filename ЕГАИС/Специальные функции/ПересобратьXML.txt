// Замена названия пространства имен на нужное намФУНКЦИЯ ЛОКАЛЬНАЯ ПересобратьXML_ЗаменитьПИ( ИмяТэга ){	ПозицияДТ	= AT( ИмяТэга, ":" );	IF ( ПозицияДТ != 0 )	{		ПИ		= ЛЕВСИМВ( ИмяТэга, ПозицияДТ - 1 );		FOR ( индекс = 0; индекс < КоличествоЗамен; индекс++ )		{			IF ( ПИ == ЗАМЕНЯЕМОЕПИ[ индекс ] )			{				ПИ			= НАЧТОЗАМЕНЯТЬ[ индекс ];				ИмяТэга		= ПИ + ПОДСТРОКА( ИмяТэга, ПозицияДТ );				индекс		= КоличествоЗамен;			}		}	}	RETURN ИмяТэга;}ФУНКЦИЯ ЛОКАЛЬНАЯ РазобратьТэги( Родитель, ТипТэга, Имя, Значение, ФлагЗакрытия ){	IF ( ТипТэга == "АТРИБУТ" )	{		IF ( ЛЕВСИМВ( Имя, 5 ) == "xmlns" AND ЛЕВСИМВ( Имя, 6 ) != "xmlns:" )		{			ТекущееПИ					= "";			FOR ( индекс = 0; индекс < КоличествоПространств; индекс++ )				IF ( Значение == ПРОСТРАНСТВОИМЕН[ индекс ] )					ТекущееПИ			= ИМЯПРОСТРАНСТВА[ индекс ];								СТЕКПИ[ УказательСтека ]	= ТекущееПИ;		}		ELSE IF ( ЛЕВСИМВ( Имя, 6 ) == "xmlns:" )		{			ПИ							= ПОДСТРОКА( Имя, 7 );			FOR ( индекс = 0; индекс < КоличествоЗамен; индекс++ )			{				IF  ( ЗАМЕНЯЕМОЕПИ[ индекс ] == ПИ ) 				{					ЗАМЕНЯЕМОЕПИ[ индекс ]	= "";					НАЧТОЗАМЕНЯТЬ[ индекс ]	= "";				}			}			FOR ( индекс = 0; индекс < КоличествоПространств; индекс++ )				IF ( Значение == ПРОСТРАНСТВОИМЕН[ индекс ] )				{					ТекущееПИ							= ИМЯПРОСТРАНСТВА[ индекс ];					ЗАМЕНЯЕМОЕПИ[ КоличествоЗамен ]		= ПИ;					НАЧТОЗАМЕНЯТЬ[ КоличествоЗамен ]	= ТекущееПИ;					КоличествоЗамен++;				}								СТЕКПИ[ УказательСтека ]	= ТекущееПИ;			СтрокаАтрибутов		= Имя + "=""" + Значение + """";		}		ELSE			СтрокаАтрибутов		= Имя + "=""" + Значение + """";	}	ELSE IF ( !ФлагЗакрытия )	{		УказательСтека++;		СТЕКПИ[ УказательСтека ]		= ТекущееПИ;				IF ( !ПУСТО( ТекущийТэг ) )		{			// В начале добавляем список пронстранств имен			ПервыйТэг	= ПУСТО( Результат );			ТекущийТЭГ	= ПересобратьXML_ЗаменитьПИ( ТекущийТЭГ );			Результат	+= "<" + ЕСЛИ( !ПУСТО( ТекущееПИ ) AND AT( ТекущийТэг, ":" ) == 0, ТекущееПИ + ":", "" ) + ТекущийТэг + ЕСЛИ( !ПУСТО( СтрокаАтрибутов ), " " + СтрокаАтрибутов, "" );			IF ( ПервыйТэг )			{				FOR ( индекс = 0; индекс < КоличествоПространств; индекс++ )					Результат	+= " xmlns:" + ИМЯПРОСТРАНСТВА[ индекс ] + "=""" + ПРОСТРАНСТВОИМЕН[ индекс ] + """";							}			Результат	+= ">";		}		//		Имя					= ПересобратьXML_ЗаменитьПИ( Имя );		ТекущийТэг			= Имя;		СтрокаАтрибутов		= "";	}	ELSE 	{		Имя					= ПересобратьXML_ЗаменитьПИ( Имя );		IF ( !ПУСТО( ТекущийТэг ) )			Результат		+= "<" + ЕСЛИ( !ПУСТО( ТекущееПИ ) AND AT( Имя, ":" ) == 0, ТекущееПИ + ":", "" ) + Имя + ЕСЛИ( !ПУСТО( СтрокаАтрибутов ), " " + СтрокаАтрибутов, "" ) + ">";		Результат			+= ALLTRIM( ЕГАИС.ЗаменитьСимволы( Значение ) ) + "</" + ЕСЛИ( !ПУСТО( ТекущееПИ ) AND AT( Имя, ":" ) == 0, ТекущееПИ + ":", "" ) + Имя + ">";				УказательСтека		-= 1;		ТекущееПИ			= СТЕКПИ[ УказательСтека ];		ТекущийТэг			= "";	}}ПРОСТРАНСТВОИМЕН[ 0 ]	= "http://fsrar.ru/WEGAIS/WB_DOC_SINGLE_01";ПРОСТРАНСТВОИМЕН[ 1 ]	= "http://fsrar.ru/WEGAIS/Common";ПРОСТРАНСТВОИМЕН[ 2 ]	= "http://fsrar.ru/WEGAIS/ClientRef";ПРОСТРАНСТВОИМЕН[ 3 ]	= "http://fsrar.ru/WEGAIS/ProductRef";ПРОСТРАНСТВОИМЕН[ 4 ]	= "http://fsrar.ru/WEGAIS/TTNSingle";ПРОСТРАНСТВОИМЕН[ 5 ]	= "http://fsrar.ru/WEGAIS/ClientRef_v2";ПРОСТРАНСТВОИМЕН[ 6 ]	= "http://fsrar.ru/WEGAIS/ProductRef_v2";ПРОСТРАНСТВОИМЕН[ 7 ]	= "http://fsrar.ru/WEGAIS/TTNSingle_v2";ПРОСТРАНСТВОИМЕН[ 8 ]	= "http://fsrar.ru/WEGAIS/TTNSingle_v3";ПРОСТРАНСТВОИМЕН[ 9 ]	= "http://fsrar.ru/WEGAIS/CommonV3";ПРОСТРАНСТВОИМЕН[ 10 ]	= "http://fsrar.ru/WEGAIS/TTNSingle_v4";ИМЯПРОСТРАНСТВА[ 0 ]	= "ns";ИМЯПРОСТРАНСТВА[ 1 ]	= "c";ИМЯПРОСТРАНСТВА[ 2 ]	= "oref";ИМЯПРОСТРАНСТВА[ 3 ]	= "pref";ИМЯПРОСТРАНСТВА[ 4 ]	= "wb";ИМЯПРОСТРАНСТВА[ 5 ]	= "oref";ИМЯПРОСТРАНСТВА[ 6 ]	= "pref";ИМЯПРОСТРАНСТВА[ 7 ]	= "wb";ИМЯПРОСТРАНСТВА[ 8 ]	= "wb";ИМЯПРОСТРАНСТВА[ 9 ]	= "ce";ИМЯПРОСТРАНСТВА[ 10 ]	= "wb";ЗАМЕНЯЕМОЕПИ[ 0 ]		= "";НАЧТОЗАМЕНЯТЬ[ 0 ]		= "";КоличествоПространств	= 11;КоличествоЗамен			= 0;ТекущийТэг				= "";СтрокаАтрибутов			= "";ТекущееПИ				= "";УказательСтека			= 0;СТЕКПИ[ 0 ]				= "";//Файл					= ФАЙЛСОЗДАТЬ( "d:\result.txt" );Результат				= "";РАЗОБРАТЬ_XML( Текст, "РазобратьТэги" );Результат				= ПЕРЕКОДИРОВАТЬ( Результат, "ANSI", "UTF-8" );//ФайлЗаписать( Файл, Результат );//ФайлЗакрыть( Файл );RETURN Результат;
