// По коду предприятия необходимо определить систему ЭДО, с которой работает пользователь.
// В зависимости от системы вызвать нужную функцию.

РезультатОтправки		= true;
СИСТЕМАЭДО				= ЗАПРОС( "SELECT value FROM param_ex WHERE param= 'MARK_EDI" + ПРЕДПРИЯТИЕ + "'" );
КоличествоДокументов	= 0;
ДОБАВИТЬКОНТЕКСТ( "SELECT guid FROM " + ИМЯТАБЛИЦЫ, "СписокОтправокВЭДО" );
try
{
	ПОКА ( !КОНЕЦКОНТЕКСТА( "СписокОтправокВЭДО" ) )
	{
		IF ( СИСТЕМАЭДО == "ЭВОТОР" )
		{
			IF ( !МАРКИРОВКА.ЭВОТОРОтправкаОтгрузки( ПРЕДПРИЯТИЕ, СписокОтправокВЭДО.guid ) ) THROW;
		}
		ELSE IF ( СИСТЕМАЭДО == "КОНТУР" )
		{
			IF ( !МАРКИРОВКА.КОНТУРОтправкаОтгрузки( ПРЕДПРИЯТИЕ, СписокОтправокВЭДО.guid ) ) THROW;
		}
		ELSE IF ( СИСТЕМАЭДО == "СБИС" )
		{
			IF ( !МАРКИРОВКА.СБИСОтправкаОтгрузки( ПРЕДПРИЯТИЕ, СписокОтправокВЭДО.guid ) ) THROW;
		}
		ELSE IF ( СИСТЕМАЭДО == "ТАКСКОМ" )
		{
			IF ( !МАРКИРОВКА.ТАКСКОМОтправкаОтгрузки( ПРЕДПРИЯТИЕ, СписокОтправокВЭДО.guid ) ) THROW;
		}
		ELSE IF ( !МАРКИРОВКА.ВыгрузкаУПДВФайл ( ПРЕДПРИЯТИЕ, СписокОтправокВЭДО.guid ) ) THROW;

		ПРОПУСТИТЬ( 1, "СписокОтправокВЭДО" );
		КоличествоДокументов++;
	}
}
catch( )
{
	РезультатОтправки	= false;
}
СООБЩЕНИЕ( "В систему ЭДО было отправлено " + ПРОПИСЬ( КоличествоДокументов, "документ", "документа", "документов" ) + "." + 
			ЕСЛИ( КоличествоДокументов > 0, CHR( 13 ) + "Для отслеживания статусов документов периодически получайте данные из системы ЭДО.", "" ) );
УДАЛИТЬКОНТЕКСТ( "СписокОтправокВЭДО" );
RETURN РезультатОтправки;
