Меркурий.ЗагрузитьПараметры( );ИМЯТАБЛИЦЫ				= "##" + УНИКАЛЬНОЕИМЯ( );__SQL( ) {	CREATE TABLE [[ИМЯТАБЛИЦЫ]] ( producttype char( 1 ) DEFAULT '', product varchar( 50 ) DEFAULT '', subproduct varchar( 50 ) DEFAULT '', name varchar( 250 ) DEFAULT '', type_ char( 1 ) );}// Если выполняется частичное обновление, то вызываем одну из функцийIF ( !ПОЛНОЕОБНОВЛЕНИЕ ){	// Если пустая "папка", то удаляем все и заполняем первый уровень	IF ( ПУСТО( ТИПУЗЛА ) )	{		Меркурий.ЗаполнитьВерхнийУровеньИерархииПродукции( ИМЯТАБЛИЦЫ );		__SQL( ) {						BEGIN TRANSACTION			DELETE FROM mrc_wares_fld;			INSERT INTO mrc_wares_fld ( producttype, product, subproduct, name, type_ )			SELECT producttype, product, subproduct, name, type_			FROM [[ИМЯТАБЛИЦЫ]];			COMMIT		}				RETURN;	}		IF ( ТИПУЗЛА == "T" AND !ПУСТО( ТИППРОДУКЦИИ ) )	{		IF ( !Меркурий.ЗапросСправочникаПродукции( ТИППРОДУКЦИИ, ИМЯТАБЛИЦЫ, true ) ) RETURN false;		__SQL( ) {						BEGIN TRANSACTION			DELETE FROM mrc_wares_fld WHERE producttype= '[[ТИППРОДУКЦИИ]]' AND type_ <> 'T'; 			INSERT INTO mrc_wares_fld ( producttype, product, subproduct, name, type_ )			SELECT producttype, product, subproduct, name, type_			FROM [[ИМЯТАБЛИЦЫ]];			COMMIT		}	}	ELSE IF ( ТИПУЗЛА == "P" AND !ПУСТО( ПРОДУКЦИЯ ) )	{		IF ( !Меркурий.ЗапросСправочникаСубПродукции( ТИППРОДУКЦИИ, ПРОДУКЦИЯ, НАИМЕНОВАНИЕПРОДУКЦИИ, ИМЯТАБЛИЦЫ ) ) RETURN false;		__SQL( ) {						BEGIN TRANSACTION			DELETE FROM mrc_wares_fld WHERE producttype= '[[ТИППРОДУКЦИИ]]' AND product= '[[ПРОДУКЦИЯ]]' AND type_ = 'S'; 			INSERT INTO mrc_wares_fld ( producttype, product, subproduct, name, type_ )			SELECT producttype, product, subproduct, name, type_			FROM [[ИМЯТАБЛИЦЫ]];			COMMIT		}	}	RETURN;} Меркурий.ЗаполнитьВерхнийУровеньИерархииПродукции( ИМЯТАБЛИЦЫ );IF ( !Меркурий.ЗапросСправочникаПродукции( "1", ИМЯТАБЛИЦЫ, false ) ) RETURN false;IF ( !Меркурий.ЗапросСправочникаПродукции( "2", ИМЯТАБЛИЦЫ, false ) ) RETURN false;IF ( !Меркурий.ЗапросСправочникаПродукции( "3", ИМЯТАБЛИЦЫ, false ) ) RETURN false;IF ( !Меркурий.ЗапросСправочникаПродукции( "4", ИМЯТАБЛИЦЫ, false ) ) RETURN false;IF ( !Меркурий.ЗапросСправочникаПродукции( "5", ИМЯТАБЛИЦЫ, false ) ) RETURN false;IF ( !Меркурий.ЗапросСправочникаПродукции( "6", ИМЯТАБЛИЦЫ, false ) ) RETURN false;IF ( !Меркурий.ЗапросСправочникаПродукции( "7", ИМЯТАБЛИЦЫ, false ) ) RETURN false;IF ( !Меркурий.ЗапросСправочникаПродукции( "8", ИМЯТАБЛИЦЫ, false ) ) RETURN false;	// Полученные даныне переносим с таблицу mrc_wares_fld__SQL( ) {		BEGIN TRANSACTION	DELETE FROM mrc_wares_fld;	INSERT INTO mrc_wares_fld ( producttype, product, subproduct, name, type_ )	SELECT producttype, product, subproduct, name, type_	FROM [[ИМЯТАБЛИЦЫ]];	COMMIT}RETURN true;
