// Для запроса адресов необходимо сначала запросить getBusinessEntityByGuidRequestТекст = "<soapenv:Envelope xmlns:soapenv=""http://schemas.xmlsoap.org/soap/envelope/"" xmlns:v2=""http://api.vetrf.ru/schema/cdm/registry/ws-definitions/v2""				  xmlns:base=""http://api.vetrf.ru/schema/cdm/base"" xmlns:v21=""http://api.vetrf.ru/schema/cdm/dictionary/v2"">   <soapenv:Header/>   <soapenv:Body>	  <v2:getActivityLocationListRequest>		 <base:listOptions>			<base:count>1000</base:count>			<base:offset>0</base:offset>		 </base:listOptions>		<v21:businessEntity>			<base:guid>" + ЕГАИС.ЗаменитьСимволы( МЕРКУРИЙХОЗСУБЪЕКТ ) + "</base:guid>		 </v21:businessEntity>	   </v2:getActivityLocationListRequest>   </soapenv:Body></soapenv:Envelope>";ОтветСервера			= Меркурий.ОтправитьЗапрос( Текст, "ПРЕДПРИЯТИЯ", МЕРКУРИЙЛОГИН, МЕРКУРИЙПАРОЛЬ, МЕРКУРИЙТЕСТОВЫЙКОНТУР );ДОБАВИТЬКОНТЕКСТ( "SET FMTONLY ON SELECT '' AS bs_guid, '' AS dt_name, '' AS dt_addressView SET FMTONLY OFF", "Адреса" );ЗАГРУЗИТЬ( "Адреса", "XMLSTRING", ОтветСервера, "dt:enterprise", "", "dt:enterprise", "dt:numberList dt:owner dt:officialRegistration dt:country dt:region dt:district dt:locality dt:subLocality dt:street" );ПЕРЕЙТИВНАЧАЛО( "Адреса" );WHILE ( !КОНЕЦКОНТЕКСТА( "Адреса" ) ){	__SQL {		IF EXISTS( SELECT * FROM mrc_enterprises WHERE guid = '[[STDF( Адреса.bs_guid )]]' ) 			UPDATE mrc_enterprises SET businessid= '[[STDF( МЕРКУРИЙХОЗСУБЪЕКТ )]]', name= '[[STDF( Адреса.dt_name )]]', 									   apitest= [[ЕСЛИ( МЕРКУРИЙТЕСТОВЫЙКОНТУР, "1", "0" ) ]], initiator= '[[ STDF( МЕРКУРИЙИНИЦИАТОР ) ]]', apikey= '[[ STDF( МЕРКУРИЙКЛЮЧ ) ]]',									   login= '[[ STDF( МЕРКУРИЙЛОГИН ) ]]', password= '[[ STDF( МЕРКУРИЙПАРОЛЬ ) ]]'			WHERE guid = '[[STDF( Адреса.bs_guid )]]';		ELSE			INSERT INTO mrc_enterprises ( businessid, guid, name, apitest, initiator, apikey, login, password ) 			VALUES ( '[[STDF( МЕРКУРИЙХОЗСУБЪЕКТ )]]', '[[STDF( Адреса.bs_guid )]]', '[[STDF( Адреса.dt_name )]]', [[ЕСЛИ( МЕРКУРИЙТЕСТОВЫЙКОНТУР, "1", "0" ) ]],					 '[[ STDF( МЕРКУРИЙИНИЦИАТОР ) ]]', '[[ STDF( МЕРКУРИЙКЛЮЧ ) ]]', '[[ STDF( МЕРКУРИЙЛОГИН ) ]]', '[[ STDF( МЕРКУРИЙПАРОЛЬ ) ]]' );	}	ПРОПУСТИТЬ( 1, "Адреса" );}УДАЛИТЬ( "ALL", "Адреса" );RETURN true;
