IF ( ПЕРЕМЕННАЯ("UNCONFIRMEDID", false ) == false ) RETURN true;

IF ( НОМЕРПОДЧЕКА == 1 AND НОМЕРПОДЧЕКА <= ВСЕГОЧЕКОВ)
	ДОБАВИТЬКОНТЕКСТ("SELECT * FROM paycardtrans WHERE owner = '" + _UNCONFIRMEDID + "' AND fr_code IN ('','" + ФР.КОДОБОРУДОВАНИЯ() + "')", "ОперацииПС");
ELSE
	ДОБАВИТЬКОНТЕКСТ("SELECT * FROM paycardtrans WHERE owner = '" + _UNCONFIRMEDID + "' AND fr_code = '" + ФР.КОДОБОРУДОВАНИЯ() + "'", "ОперацииПС");
	
ВЫБРАТЬКОНТЕКСТ("ОперацииПС");
IF ( КОЛИЧЕСТВОСТРОК("ОперацииПС") > 0 )
{
	ПЕРЕЙТИВНАЧАЛО("ОперацииПС");
	WHILE ( !КОНЕЦКОНТЕКСТА("ОперацииПС") )
	{
		КоличествоСлипов = VAL(ОперацииПС.slipcount);
		СлипЧек = ОперацииПС.slip;
		
		ФР.ККТ_НапечататьСлипНаФР( МОДЕЛЬОБОРУДОВАНИЯ, СлипЧек, КоличествоСлипов);
		ПРОПУСТИТЬ( 1, "ОперацииПС");
	}
}
RETURN true;
