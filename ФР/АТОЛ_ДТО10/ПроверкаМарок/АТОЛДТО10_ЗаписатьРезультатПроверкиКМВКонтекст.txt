//проверим существование контекста с результатами проверок и, если нет констекста, создадим его
IF ( !ВЫБРАТЬКОНТЕКСТ( "РезультатыОбработкиКМ" ) )
	IF ( !ДОБАВИТЬКОНТЕКСТ( "LOCAL: Штрихкод text, Результат text", "РезультатыОбработкиКМ" ) ) 
	{
		СООБЩЕНИЕ("Не удалось сохранить результаты проверки кода маркировки");
		RETURN false;
	}

ВЫБРАТЬКОНТЕКСТ( "РезультатыОбработкиКМ" );
ПЕРЕЙТИВНАЧАЛО( "РезультатыОбработкиКМ" );
НАШЛИ			= false;

WHILE ( !КОНЕЦКОНТЕКСТА( "РезультатыОбработкиКМ" ) && !НАШЛИ )
{
	НАШЛИ		= ALLTRIM( РезультатыОбработкиКМ.Штрихкод ) == ALLTRIM( ШТРИХКОДМАРКИРОВКИ );
	IF ( !НАШЛИ ) ПРОПУСТИТЬ( 1, "РезультатыОбработкиКМ" );
}
IF ( !НАШЛИ )
{
	//если нет такого КМ в результатах, то добавляем новую строку
	ДОБАВИТЬСТРОКИ( 1, "РезультатыОбработкиКМ" );	
	ИЗМЕНИТЬПОЛЕ( "РезультатыОбработкиКМ", "Штрихкод", ALLTRIM(ШТРИХКОДМАРКИРОВКИ) );
}
//сохраним результаты проверки в контекст
ИЗМЕНИТЬПОЛЕ( "РезультатыОбработкиКМ", "Результат", РЕЗУЛЬТАТПРОВЕРКИСВЕДЕНИЙОКМ );
