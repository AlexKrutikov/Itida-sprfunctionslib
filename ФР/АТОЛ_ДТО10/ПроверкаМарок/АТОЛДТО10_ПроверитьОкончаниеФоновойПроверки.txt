ФоноваяПроверкаЗавершена = false;
ТекстПроверкиГотовностиПроверки = "{""type"": ""checkMarkingCodeValidationsReady""}";
КонецОжидания = TICKCOUNT() + ТАЙМАУТ;

WHILE (!ФоноваяПроверкаЗавершена AND TICKCOUNT() < КонецОжидания)
{
	fptr.setParam( fptr.LIBFPTR_PARAM_JSON_DATA, ТекстПроверкиГотовностиПроверки );
	fptr.processJson( );
	
	IF (ФР.АТОЛДТО10_ЗакрытьФРСПроверкойНаОшибки("Проверка КМ", false))
	{
		ФР.АТОЛДТО10_ОтключитьККТ();
		УДАЛИТЬКОНТЕКСТ("НовыеКомандыЧека");
		УДАЛИТЬКОНТЕКСТ("ПозицииЧека");
		RETURN false;
	}
	
	СтатусПроверкиКМ	= fptr.getParamString( fptr.LIBFPTR_PARAM_JSON_DATA );
	ЗАГРУЗИТЬJSON("СостояниеФоновойПроверки", СтатусПроверкиКМ);
	ФоноваяПроверкаЗавершена = ПОЛЕ_JSON(СостояниеФоновойПроверки, "validationReady", false);
}

RETURN ФоноваяПроверкаЗавершена;
