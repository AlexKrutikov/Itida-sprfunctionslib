// Внесение наличных

// Параметры - 
// Сумма число вещественное, сумма вносимых наличных денег.
IF ( !ФР.МЕРКУРИЙФР_ОткрытьСессию( КОДОБОРУДОВАНИЯ, "Внесение наличных" ) ) RETURN false;

_ИМЯКАССИРА		= "";
_ИННКАССИРА		= "";
IF ( !ФР.МЕРКУРИЙФР_ПолучитьДанныеКассира(froperator, @_ИМЯКАССИРА, @_ИННКАССИРА) )
	_ИМЯКАССИРА = "Кассир";

//sessionKey = ДАННЫЕ_JSON("sessionKey", ALLTRIM(_КЛЮЧ_СЕССИИ) );
Команда = ДАННЫЕ_JSON("command", "BringMoney");

КоэффициентСумм = 100;
ТекстЗапроса = "{
	""sessionKey"": """ + _КЛЮЧ_СЕССИИ  + """,
	" + Команда + ",
	""cash"": " + СТРОКА( Сумма * КоэффициентСумм, 16, 0 ) + ",
	""cashierInfo"": {
		""cashierName"": """ + _ИМЯКАССИРА + """,
		""cashierINN"": """ + _ИННКАССИРА + """
	}
}
";

ОТВЕТ = "";

IF ( !ФР.МЕРКУРИЙФР_HTTPPOST(ФР.МЕРКУРИЙФР_АДРЕССЕРВЕРА(), "/api.json", ТекстЗапроса, "", @ОТВЕТ) )
	RETURN false;
		
RETURN ФР.МЕРКУРИЙФР_ЗакрытьСессию( КОДОБОРУДОВАНИЯ, "Внесение наличности" );
