IF ( ПУСТО( НОМЕРКАРТЫ ) AND ПУСТО( НОМЕРТЕЛЕФОНА ) )
{
	СООБЩЕНИЕ("Не определен номер карты или телефон клиента. " + CHR(13) + CHR(10) + "Информация по карте загружена не будет.", "Locards - получение данных");
	RETURN "";
}

Локардс_Токен = RESTAPI.LOCARDS_TOKEN( НОМЕРКАРТЫ );
IF ( ПУСТО(Локардс_Токен) )
{
	СООБЩЕНИЕ("Не определен токен LOCARDS. " + CHR(13) + CHR(10) + "Информация по карте загружена не будет.", "Locards - получение данных");
	RETURN "";
}

ИнформацияОКарте = "";
УспешноеПолучение = false;
Локардс_АдресСервера = "https://api.lo.cards";

IF ( !ПУСТО( НОМЕРКАРТЫ ) )
	АдресРесурса = "/v1/crm/card/" + ALLTRIM( НОМЕРКАРТЫ );
ELSE IF ( !ПУСТО( НОМЕРТЕЛЕФОНА ) )
	АдресРесурса = "/v1/crm/card/search?phone=" + ALLTRIM( НОМЕРТЕЛЕФОНА );	

Заголовки[0] = "Authorization: Bearer " + ALLTRIM( Локардс_Токен );	
Заголовки[1] = "Content-Type: application/json; charset=utf-8";	
	
ОТВЕТ_локардс = RESTAPI.LOCARDS_GETЗАПРОС( Локардс_АдресСервера, АдресРесурса, "Заголовки" );

IF ( !ПУСТО( ОТВЕТ_локардс) AND ОТВЕТ_локардс != false )
{
	УспешноеПолучение = ПОЛЕ_JSON( ОТВЕТ_локардс, "success", false);
	IF ( УспешноеПолучение == true OR УспешноеПолучение == "true" )
		ИнформацияОКарте = ПОЛЕ_JSON( ОТВЕТ_локардс, "data", "");	
}

RETURN ИнформацияОКарте;
