Локардс_Токен = RESTAPI.LOCARDS_TOKEN( "" );
IF ( ПУСТО(Локардс_Токен) )
{
	СООБЩЕНИЕ("Не определен токен LOCARDS. " + CHR(13) + CHR(10) + "Выгрузка карт в Locards проведена не будет.", "Locards - выгрузка карт");
	RETURN false;
}


ДанныеКатегории = "";
ДанныеКатегории += "{";
ДанныеКатегории += ДАННЫЕ_JSON("id", ПЕРЕКОДИРОВАТЬ( "Бонус" , "ANSI", "UTF-8" ) ) + ",";
ДанныеКатегории += ДАННЫЕ_JSON("name", ПЕРЕКОДИРОВАТЬ( "Бонус" , "ANSI", "UTF-8" ) );
ДанныеКатегории += "}";

ДанныеКатегории += ",";

ДанныеКатегории += "{";
ДанныеКатегории += ДАННЫЕ_JSON("id", ПЕРЕКОДИРОВАТЬ( "Скидки" , "ANSI", "UTF-8" ) ) + ",";
ДанныеКатегории += ДАННЫЕ_JSON("name", ПЕРЕКОДИРОВАТЬ( "Скидки" , "ANSI", "UTF-8" ) );
ДанныеКатегории += "}";
	
IF ( !ПУСТО( ДанныеКатегории ) )
{
	ТелоЗапроса = "{" + """categories"": [" + ДанныеКатегории + "] }";

	УспешноеВыполнение = false;
	Локардс_АдресСервера = "https://api.lo.cards";

	АдресРесурса = "/v1/crm/category/import";

	Заголовки[0] = "Authorization: Bearer " + ALLTRIM( Локардс_Токен );	
	Заголовки[1] = "Content-Type: application/json; charset=utf-8";	
	
	СИСТЕМНОЕСООБЩЕНИЕ("Отправка запроса со списком категорий в LoCards");
	ОТВЕТ_локардс = RESTAPI.LOCARDS_POSTЗАПРОС( Локардс_АдресСервера, АдресРесурса, ТелоЗапроса, "Заголовки" );

	IF ( !ПУСТО( ОТВЕТ_локардс) AND ОТВЕТ_локардс != false )
		УспешноеВыполнение = ПОЛЕ_JSON( ОТВЕТ_локардс, "success", false);
}
ELSE
{
	СООБЩЕНИЕ("Нет категорий для выгрузки", "LoCards - выгрузка категорий");
	УспешноеВыполнение = true;
}
	
СИСТЕМНОЕСООБЩЕНИЕ();

RETURN УспешноеВыполнение == true OR УспешноеВыполнение == "true";
