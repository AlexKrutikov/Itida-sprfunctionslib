//Логирование
//определим расположение файла лога
ПутьКФайлу = "";

IF (ПУСТО(ПОЛНЫЙПУТЬКФАЙЛУ))
{
	ПутьКФайлу = ПОКРУЖЕНИЯ("appdata");
	
	//на всякий случай проверим существование каталога
	IF ( !ФАЙЛ(ПутьКФайлу, 1) )
	{
		//если нет каталога в системе, то будем далее пытаться писать во временный каталог
		ПутьКФайлу = ВРЕМЕННЫЙКАТАЛОГ();
	}
	ELSE
	{
		//если каталог есть в системе, то проверим наличие вложенного каталога Itida
		IF ( !ФАЙЛ(ПутьКФайлу + "\Itida", 1) )
		{
			//если нет каталога Itida, то создадим его
			IF ( КАТАЛОГСОЗДАТЬ(ПутьКФайлу + "\Itida") )
			{
				//если каталог создался, то меняем полный путь с учетом созданного каталога
				ПутьКФайлу = ПутьКФайлу + "\Itida";
			}
		}
		ELSE
		{
			ПутьКФайлу = ПутьКФайлу + "\Itida";
		}
	}
}
ELSE
{
	ПутьКФайлу = LEFT(ПОЛНЫЙПУТЬКФАЙЛУ, RAT(ПОЛНЫЙПУТЬКФАЙЛУ, "\"));	
}

ИмяФайлаЖурнала = ПутьКФайлу + ЕСЛИ(ПУСТО(ПутьКФайлу),"","\") + ИМЯФАЙЛА + "_" + ALLTRIM( ПЕРЕМЕННАЯ("КОДОБОРУДОВАНИЯ", "") ) + ".txt";

IF ( !ФАЙЛ( ИмяФайлаЖурнала ) )
{
	ФайлЖурнала				= ФАЙЛСОЗДАТЬ( ИмяФайлаЖурнала );
	IF ( ФайлЖурнала == -1 )
	{
		_КОДОШИБКИ			= "001";
		_ТЕКСТОШИБКИ		= "Не удалось создать файл журнала '" + ALLTRIM( ИмяФайлаЖурнала );
		_ОШИБКАВЫПОЛНЕНИЯ	= true;
		RETURN "";
	}
	ФАЙЛЗАКРЫТЬ( ФайлЖурнала );
}
RETURN ИмяФайлаЖурнала;
